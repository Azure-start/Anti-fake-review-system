# 区块链电商防刷评系统前端开发计划

# 基于区块链电商防刷评系统 - 前端详细开发计划



## 一、计划概述



### 1.1 开发目标



完成前端全流程功能开发，实现与MetaMask钱包的安全交互、电商核心业务（商品浏览、交易、评价）可视化呈现、链上数据实时同步与展示，打造流畅、安全、易用的Web3.0电商评价平台前端界面，适配主流浏览器（Chrome、Firefox、Brave、Opera），兼容测试网络（如Sepolia）操作场景。



### 1.2 技术栈明细



|技术类别|具体技术/工具|应用场景|
|---|---|---|
|核心框架|Vue 3（Composition API）|页面组件化开发、状态管理、逻辑复用|
|路由管理|Vue Router 4|页面跳转、路由守卫（如登录校验）、路由参数传递|
|状态管理|Pinia|全局状态（用户钱包信息、测试币余额、商品列表）管理|
|钱包交互|Ethers.js 6.x + MetaMask|钱包连接、签名验证、网络切换、链上交易发起|
|UI组件库|Element Plus|表单、按钮、弹窗、商品卡片、评价列表等基础组件|
|网络请求|Axios|后端接口（商品数据、交易记录）请求、异常处理|
|构建工具|Vite|项目打包、热更新、环境配置（开发/测试/生产）|
|代码规范|ESLint + Prettier|语法校验、代码格式统一|
|测试工具|Vitest + Testing Library|组件单元测试、交互逻辑测试|


## 二、阶段划分与任务拆解（总周期：8周）



### 阶段1：项目初始化与基础配置（第1周）



#### 核心目标



搭建前端项目框架，完成基础配置与依赖引入，确保开发环境可正常运行。



#### 具体任务



1. **项目初始化**

    - 使用Vite创建Vue 3项目，配置TypeScript（可选，提升代码类型安全性）。

    - 安装核心依赖：Vue Router、Pinia、Element Plus、Ethers.js、Axios等。

    - 配置Vite环境变量：区分开发环境（DEV）、测试环境（TEST），设置后端接口基础URL、区块链测试网络ID（如Sepolia的Chain ID：11155111）。

2. **基础架构搭建**

    - 规划项目目录结构：`src/views`（页面）、`src/components`（公共组件）、`src/store`（Pinia状态）、`src/utils`（工具函数）、`src/api`（接口请求）、`src/assets`（静态资源）。

    - 配置Vue Router：定义初始路由（首页、商品详情页、登录页、评价发布页），设置路由守卫（未连接钱包时跳转至登录页）。

    - 初始化Pinia：创建全局状态模块（`userStore`：用户钱包信息、余额；`productStore`：商品列表；`chainStore`：区块链网络状态）。

3. **开发环境验证**

    - 编写测试页面（如首页），引入Element Plus按钮组件，验证UI库是否正常加载。

    - 编写MetaMask连接测试脚本，确保Ethers.js可正常调用钱包接口，输出钱包地址与当前网络信息。

    - 配置ESLint与Prettier，执行代码规范校验，修复初始报错。



#### 交付物



- 可运行的前端项目框架（本地启动后可访问首页）。

- 完整的项目目录结构与配置文件（`vite.config.ts`、`router/index.ts`、`store/index.ts`）。

- 环境变量配置文档（说明各环境参数含义与修改方式）。



### 阶段2：钱包交互模块开发（第2周）



#### 核心目标



实现MetaMask钱包的连接、登录、网络切换、签名验证等核心交互功能，保障用户身份确权流程顺畅。



#### 具体任务



1. **钱包连接功能**

    - 开发“连接钱包”组件（`components/WalletConnectBtn.vue`）：点击按钮唤起MetaMask，获取用户钱包地址与公钥，存储至`userStore`。

    - 处理异常场景：钱包未安装时提示“请安装MetaMask插件”；用户拒绝连接时显示“连接已取消”弹窗。

2. **网络检测与切换**

    - 开发区块链网络检测工具函数（`utils/chainHelper.ts`）：通过Ethers.js获取当前钱包网络ID，与预设的测试网络ID对比。

    - 实现网络切换逻辑：若当前网络非Sepolia，弹窗提示“请切换至Sepolia测试网络”，并提供“一键切换”按钮（调用MetaMask的`wallet_switchEthereumChain`接口）。

3. **签名验证与登录态维护**

    - 开发“签名登录”功能：后端生成随机字符串（nonce），前端调用MetaMask签名接口（`signMessage`），将签名结果回传后端验证，验证通过后维护登录态（存储token至localStorage）。

    - 登录态持久化：页面刷新时，通过`userStore`读取localStorage中的钱包地址与token，自动恢复登录状态。



#### 交付物



- 钱包连接组件（可正常唤起MetaMask并获取地址）。

- 网络切换功能（自动检测网络，支持一键切换至Sepolia）。

- 登录态维护逻辑（签名验证通过后可保持登录状态，刷新页面不失效）。

- 异常处理案例文档（记录钱包未安装、用户拒绝连接等场景的处理方式）。



### 阶段3：电商核心页面开发（第3-4周）



#### 核心目标



完成首页、商品详情页、交易确认页的开发，实现商品数据展示、交易发起等基础电商功能。



#### 具体任务（第3周：首页与商品列表）



1. **首页开发**

    - 页面结构：顶部导航栏（包含“连接钱包”按钮、用户地址显示、测试币余额）、商品搜索框、商品分类栏、商品列表区。

    - 商品列表组件（`components/ProductCard.vue`）：展示商品图片、名称、价格、评分、已售数量，点击卡片跳转至商品详情页。

    - 接口集成：通过Axios调用后端`/api/products`接口，获取商品列表数据，存储至`productStore`，实现列表分页加载。

2. **商品详情页开发**

    - 页面结构：商品轮播图、基本信息（名称、价格、规格）、商家信息、评价列表入口、“立即购买”按钮。

    - 评价预览区：展示3条最新真实评价（调用后端`/api/products/{id}/reviews`接口），显示评价内容、评分、用户地址（脱敏处理，如“0x123...456”）。

    - 规格选择功能：支持用户选择商品规格（如尺寸、颜色），选择后更新“立即购买”按钮对应的商品ID与价格。



#### 具体任务（第4周：交易确认与记录页）



1. **交易确认页开发**

    - 页面结构：商品信息回顾（规格、价格）、收货地址表单（需用户填写，暂存至前端，后续可对接链上存证）、“确认购买”按钮。

    - 交易发起逻辑：点击“确认购买”后，调用后端`/api/transactions/create`接口生成交易订单，获取交易哈希（txHash），并通过Ethers.js发起链上支付（测试币转账），等待区块确认。

    - 交易状态展示：显示“等待支付”“支付中”“支付成功”“支付失败”状态，支付成功后跳转至商品详情页，并提示“可发布评价”。

2. **交易记录页开发**

    - 接口集成：调用后端`/api/transactions/user`接口，获取当前用户的交易记录（待支付、已完成、已取消）。

    - 记录列表展示：按交易时间倒序排列，显示交易单号、商品名称、金额、状态，点击记录可查看详情。



#### 交付物



- 首页（商品列表可正常加载、分页）、商品详情页（规格选择、评价预览）、交易确认页（支付发起、状态展示）、交易记录页。

- 商品与交易相关接口请求封装（`api/productApi.ts`、`api/transactionApi.ts`）。

- 页面交互测试报告（记录商品跳转、规格选择、支付发起等流程是否正常）。



### 阶段4：评价功能模块开发（第5-6周）



#### 核心目标



实现评价发布、评价列表展示、评价NFT生成提示等功能，确保评价数据与链上信息同步。



#### 具体任务（第5周：评价发布页开发）



1. **评价发布表单设计**

    - 表单结构：评分选择（1-5星）、文字评价输入框（最小长度限制：10字）、图片上传（可选，最多3张）、“提交评价”按钮。

    - 输入校验：使用Element Plus表单校验规则，确保评分必选、文字评价不低于最小长度，未达标时提示用户。

2. **链上校验与评价提交**

    - 提交前校验：调用`chainStore`中的工具函数，校验用户是否完成对应商品的交易（通过交易哈希查询链上记录），未完成交易时禁止提交。

    - 评价上链发起：点击“提交”后，前端将评价数据（评分、内容、商品ID、用户地址）传递给后端，后端触发智能合约调用，生成评价NFT，返回NFT ID与上链状态。

    - 提交状态反馈：显示“评价提交中”“上链成功”“上链失败”弹窗，成功后跳转至商品详情页的评价列表区。



#### 具体任务（第6周：评价列表与NFT展示）



1. **评价列表优化**

    - 评价筛选功能：支持按评分（高到低/低到高）、时间（最新/最早）筛选，添加筛选条件切换按钮。

    - 评价详情展示：每条评价显示用户地址（脱敏）、评分、文字内容、上传图片（点击预览）、评价时间、NFT标识（如“已上链·NFT ID: xxx”）。

    - 链上数据同步：点击“刷新评价”按钮，调用后端接口同步链上最新评价数据，更新列表。

2. **评价NFT提示功能**

    - 开发NFT提示组件（`components/NftTip.vue`）：评价上链成功后，弹窗提示“评价已生成NFT，可在钱包中查看”，提供“复制NFT ID”按钮。

    - 钱包NFT跳转：若用户钱包支持查看NFT，提供“前往钱包查看”链接（调用MetaMask的NFT查看页面）。



#### 交付物



- 评价发布页（表单校验、链上校验、提交反馈）、评价列表页（筛选、详情展示、链上同步）。

- NFT提示组件与NFT ID复制功能。

- 评价功能测试用例（包含未完成交易提交、内容长度不足、上链失败等场景）。



### 阶段5：奖励机制与前端展示（第7周）



#### 核心目标



实现测试币奖励的前端展示、奖励记录查询、优惠券兑换功能，对接后端奖励发放接口。



#### 具体任务



1. **奖励余额与记录展示**

    - 余额实时更新：在`userStore`中添加奖励余额状态，页面加载时调用后端`/api/rewards/balance`接口获取当前用户测试币余额，交易或评价后自动刷新。

    - 奖励记录查询：开发“奖励记录”页面，调用`/api/rewards/history`接口，展示奖励来源（如“发布评价奖励”“邀请奖励”）、金额、时间、状态（已到账/待到账）。

2. **优惠券兑换功能**

    - 兑换页面开发：设计兑换表单，支持用户输入兑换码（或选择预设优惠券），调用`/api/rewards/exchange`接口发起兑换。

    - 兑换反馈：兑换成功后提示“优惠券已发放至账户”，失败时显示原因（如“兑换码无效”“测试币不足”）。

    - 优惠券列表：在“我的账户”页面添加优惠券列表，展示已兑换优惠券的名称、有效期、使用规则。

3. **反灌水机制前端适配**

    - 内容长度校验：在评价发布页设置文字输入框的最小长度限制（如10字），未达标时“提交”按钮置灰，并提示“内容需至少10字”。

    - 币天阈值提示：若用户币天未达最小阈值，在评价发布页顶部显示警告“当前币天不足，提交评价无奖励”。



#### 交付物



- 奖励余额展示组件、奖励记录页面、优惠券兑换页面与列表。

- 反灌水机制前端校验逻辑（内容长度、币天阈值提示）。

- 奖励功能接口封装（`api/rewardApi.ts`）与异常处理逻辑。



### 阶段6：测试、优化与部署（第8周）



#### 核心目标



完成前端功能测试、性能优化、兼容性适配，部署至测试环境，准备交付。



#### 具体任务



1. **功能测试与Bug修复**

    - 全流程测试：覆盖“钱包连接→商品购买→评价发布→奖励获取”全流程，验证每个环节的功能正确性。

    - 异常场景测试：测试网络切换失败、钱包断开连接、接口请求超时等场景，确保异常提示友好、不崩溃。

    - Bug修复：记录测试中发现的问题（如评价图片上传失败、奖励余额不刷新），优先级排序后逐一修复。

2. **性能与兼容性优化**

    - 性能优化：

        - 图片懒加载：商品图片、评价图片使用`v-lazy`指令，减少初始加载资源。

        - 接口缓存：对商品列表、评价数据等非实时数据设置Axios缓存，减少重复请求。

        - 组件按需加载：使用Vue Router懒加载（`component: () => import('./views/ProductDetail.vue')`），减小初始包体积。

    - 兼容性适配：

        - 在Chrome、Firefox、Brave、Opera浏览器中测试页面显示与功能，修复样式错乱、交互异常问题。

        - 适配不同屏幕尺寸（PC端：1920×1080、1366×768；平板端：1024×768），确保响应式布局正常。

3. **测试环境部署**

    - 打包测试环境代码：使用`vite build --mode test`生成测试环境包。

    - 部署至测试服务器（如Nginx），配置静态资源访问路径、跨域规则，确保前端可正常调用后端接口与区块链网络。

    - 生成部署文档：记录部署步骤、服务器地址、访问链接、环境变量配置方式。



#### 交付物



- 测试报告（包含测试用例、Bug修复记录、兼容性测试结果）。

- 优化后的前端项目代码（性能达标、无明显Bug）。

- 测试环境部署包与部署文档。

- 前端用户操作手册（简要说明钱包连接、评价发布、奖励兑换等流程）。



## 三、风险与应对措施



|风险点|影响|应对措施|
|---|---|---|
|MetaMask接口更新导致兼容性问题|钱包连接、签名功能失效|1. 锁定Ethers.js版本，避免自动升级；2. 关注MetaMask开发者文档，提前适配接口变更；3. 开发备用钱包连接方案（如Coinbase Wallet）。|
|区块链测试网络不稳定（如Sepolia拥堵）|交易确认慢、评价上链失败|1. 前端添加交易超时提示，支持重新发起；2. 与后端协作，增加测试网络切换功能（如切换至Goerli测试网）；3. 模拟测试网络拥堵场景，优化用户等待体验（如显示“当前网络拥堵，预计等待5分钟”）。|
|后端接口延迟或变更|商品数据加载慢、功能联调受阻|1. 前端添加接口请求loading状态与异常重试机制；2. 与后端约定接口文档（如Swagger），明确参数与返回格式；3. 开发Mock接口（使用Mock.js），在后端接口未就绪时支撑前端开发。|
|代码规范不统一导致协作效率低|代码维护困难、Bug率上升|1. 项目初期制定代码规范文档（如组件命名、注释格式）；2. 配置ESLint自动校验，提交代码前执行`npm run lint`；3. 使用Git Hooks（如husky），提交代码时自动格式化与校验。|


## 四、里程碑与交付节点



|里程碑|完成时间|核心交付物|
|---|---|---|
|M1：项目初始化完成|第1周末|可运行的前端项目框架、基础配置文件|
|M2：钱包交互模块完成|第2周末|钱包连接组件、网络切换功能、登录态逻辑|
|M3：电商核心页面完成|第4周末|首页、商品详情页、交易确认页、交易记录页|
|M4：评价功能模块完成|第6周末|评价发布页、评价列表页、NFT提示组件|
|M5：奖励机制功能完成|第7周末|奖励余额展示、优惠券兑换页面、反灌水校验|
|M6：测试与部署完成|第8周末|测试报告、测试环境部署包、用户操作手册|
> （注：文档部分内容可能由 AI 生成）